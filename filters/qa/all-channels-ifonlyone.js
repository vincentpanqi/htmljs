// Generated by CoffeeScript 1.9.3
(function() {
  var func_channel, func_channel_users, func_question, temp_channels;

  func_channel = __F('qa/channel');

  func_question = __F('question');

  func_channel_users = __F('qa/channel_users');

  temp_channels = [];

  module.exports = function(req, res, next) {
    return func_channel.getAll(1, 100, {
      hide: 0
    }, "sort ,id desc", function(error, channels) {
      res.locals.channels = temp_channels = channels;
      if (req.query.channel_id) {
        return func_channel.getById(req.query.channel_id, function(error, channel) {
          res.locals.channel = channel;
          return func_channel_users.getAll(1, 100, {
            channel_id: req.query.channel_id
          }, function(error, users) {
            channel.users = users;
            return next();
          });
        });
      } else {
        return next();
      }
    });
  };

}).call(this);
